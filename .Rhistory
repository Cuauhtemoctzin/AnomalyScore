matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(0,2,1,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(0,1,1,2) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,23:24],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
series_s1=readRDS("/Users/guillermocgg/Dropbox/Lancaster/MyWork/simulations/Simulationstudy_190224.rds" )
series_s1=readRDS("/Users/guillermocgg/Dropbox/Lancaster/MyWork/simulations/Simulationstudy_200224_100.rds" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,23:24],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],main="D) Only working hours shifts anomalies (OW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],main="E) Trend and shock anomalies (TS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],main="F) Shock and working hours shifts anomalies (SW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],main="G) Trend and working hours shifts anomalies (TW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,23:24],main="H) All anomalies (SWT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],main="D) Only working hours shifts anomalies (OW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],main="E) Trend and shock anomalies (TS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],main="F) Shock and working hours shifts anomalies (SW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],main="G) Trend and working hours shifts anomalies (TW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(0,3,2,1) )
matplot(series_s1[,23:24],main="H) All anomalies (SWT)", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],main="D) Only working hours shifts anomalies (OW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],main="E) Trend and shock anomalies (TS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],main="F) Shock and working hours shifts anomalies (SW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],main="G) Trend and working hours shifts anomalies (TW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(3,1,2,1) )
matplot(series_s1[,23:24],main="H) All anomalies (SWT)", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],main="D) Only working hours shifts anomalies (OW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],main="E) Trend and shock anomalies (TS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],main="F) Shock and working hours shifts anomalies (SW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],main="G) Trend and working hours shifts anomalies (TW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(2,1,2,1) )
matplot(series_s1[,23:24],main="H) All anomalies (SWT)", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],lwd=2, main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],main="D) Only working hours shifts anomalies (OW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],main="E) Trend and shock anomalies (TS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],main="F) Shock and working hours shifts anomalies (SW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],main="G) Trend and working hours shifts anomalies (TW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(2,1,2,1) )
matplot(series_s1[,23:24],main="H) All anomalies (SWT)", yaxt="n", xlab = "", ylab="", type="l" )
par(mfrow=c(8,1))
par(mar=c(0,1,2,1) )
matplot(series_s1[,1:10],main="A) No anomalies (NA)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,11:12],lwd=2, main="B) Only shock anomalies (OS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,13:14],lwd=2,main="C) Only trend anomalies (OT)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,15:16],lwd=2,main="D) Only working hours shifts anomalies (OW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,17:18],lwd=2,main="E) Trend and shock anomalies (TS)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,19:20],lwd=2,main="F) Shock and working hours shifts anomalies (SW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
matplot(series_s1[,21:22],lwd=2,main="G) Trend and working hours shifts anomalies (TW)", xaxt="n", yaxt="n", xlab = "", ylab="", type="l" )
par(mar=c(2,1,2,1) )
matplot(series_s1[,23:24],lwd=2,main="H) All anomalies (SWT)", yaxt="n", xlab = "", ylab="", type="l" )
exp(.3)
par[1]
par[2]
matplot(datasetsimul[[1]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
### series visualization
par(mfrow=c(1,1))
matplot(datasetsimul[[1]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[2]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[3]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[4]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
### series visualization
par(mfrow=c(1,1))
par(mar=c(3,1,2,1) )
matplot(datasetsimul[[4]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
### series visualization
par(mfrow=c(1,1))
par(mar=c(2,2,2,1) )
matplot(datasetsimul[[4]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[5]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[6]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[4]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[4]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matorder
dim(unit)[1]/(10)
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[l]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[1]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[2]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[3]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[5]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[7]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[8]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[10]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[12]][,1])
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
# #matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#
#
#
# unit=X1matrix
# datasetsimul[[l]]=unit
periodogram(datasetsimul[[15]][,1])
L<-.01
par<- c(exp(-L)*2*cos(2*pi*psi), -exp(-2*L)   )
Wnoise<-matrix(0,nrow = size+4, ncol = 5)
for(i in 1:5){
Wnoise[,i]<-rnorm(size+4, mean=0,sd=5)
}
X1matrix<-Wnoise
for(i in 3:(size+4) ){
X1matrix[i,1]<- par[1]*X1matrix[(i-1),1] +par[2]*X1matrix[(i-2),1] +Wnoise[i,1]
X1matrix[i,2]<-  .7*X1matrix[(i-2),1] +Wnoise[i,2]
if(i>3){ X1matrix[i,3]<-  .4*X1matrix[(i-3),1] +Wnoise[i,3] }
X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
}
X1matrix<-X1matrix[5:(size+4),]
# datasetsimul[[l]]=unit
periodogram(X1matrix)
# datasetsimul[[l]]=unit
periodogram(X1matrix[,1])
par[1]*size
par[1]
par[1]
par[2]
for( l in 1:100){
print(rep(l,30))
# Wnoise<-matrix(0,nrow = size+4, ncol = 5)
# for(i in 1:5){
#   Wnoise[,i]<-rnorm(size+4, mean=0,sd=5)
# }
#
# X1matrix<-Wnoise
#
#
# for(i in 3:(size+4) ){
#   X1matrix[i,1]<- par[1]*X1matrix[(i-1),1] +par[2]*X1matrix[(i-2),1] +Wnoise[i,1]
#   X1matrix[i,2]<-  .7*X1matrix[(i-2),1] +Wnoise[i,2]
#   if(i>3){ X1matrix[i,3]<-  .4*X1matrix[(i-3),1] +Wnoise[i,3] }
#   X1matrix[i,4]<-  -.7*X1matrix[(i-2),1]+.25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,4]
#   X1matrix[i,5]<-  .25*sqrt(2)*X1matrix[(i-1),4]+.25*sqrt(2)*X1matrix[(i-1),5]  +Wnoise[i,5]
# }
# X1matrix<-X1matrix[5:(size+4),]
#matplot(X1matrix[1:size,], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
#unit=X1matrix
# datasetsimul[[l]]=unit
#periodogram(X1matrix[,1])
unit=datasetsimul[[l]]
#update the parameters and include
dparams=list(
list(unit=unit, k=3),
list(unit=unit ),
list(unit=unit ),
list(unit=unit, k=3),
list(unit=unit, span1=5, span2=5, period = psi*size ),
list(unit=unit, span1=5, span2=5, period = psi*size*2 ),
list(unit=unit, kvar=ncol(unit), ar=c( round(psi*size,0)  ,round( psi*size*2,0 ) ), period = psi*size ),
list(unit=unit, kvar=ncol(unit), ar=c( round(psi*size,0)  ,round( psi*size*2,0 ) ), period = psi*size*2 ),
list(unit=unit , pmax=10 ),
list(unit=unit , pmax=10, period=psi*size),
list(unit=unit , pmax=10, period=psi*size*2),
list(unit=unit, Lmax=10, Tl=5, nnei=10, A=.95 ),
list(unit=unit  ),
list(unit=unit )
)
testknn=list()
time_cost=c()
#vec1=c()
for(i in 1:14){
start=Sys.time()
an.error.occured <- FALSE
tryCatch( { testknn[[i]]= kneighbors_distance_docall(knn=3, distance=functions[[i]], dparams=dparams[[i]] )}
, error = function(e) {an.error.occured <<- TRUE;
})
if(an.error.occured){next}
matorder=data.frame(num=c(1:(ncol(unit))),score=testknn[[i]]$anomalyscore )
matorder=matorder[ order(testknn[[i]]$anomalyscore,decreasing = T), ]
end=Sys.time()
time_cost[i]=end-start
print(t(matorder[ 1:5, ]) )
#vec1=c(vec1,matorder[ 1:8,1 ])
}
alltimes[[l]]=time_cost
allscores[[l]]=testknn
}
dist_names=c(
'Cort',
'Wasserstein',
'Mahalanobis',
'CortNorm',
'Coherence_P1',
'Coherence_P2',
'PDC_P1',
'PDC_P2',
'CGCI',
'RGPDC_P1',
'RGPDC_P2',
'PMIME',
'mvLWS',
'Banddepth'
)
tableslists=list()
for(ndist in 1:14){
for(l in  1:100  ){
myscore= allscores[[l]][[ndist]]$anomalyscore
if(is.null( myscore) ){next}
matorder=data.frame(num=c(1:(ncol(unit))),myscore )
matorder=matorder[ order(myscore,decreasing = T), ]
matorder$rank=(ncol(unit)):1
matorder=matorder[ order(matorder$num,decreasing = F), ]
# create data frame to plot
tempscoreframe=matorder[,c(1,3)]
if(l==1){
allscoreframe=tempscoreframe
}else{
allscoreframe=rbind(allscoreframe,tempscoreframe )
}
}#l
print(dist_names[ndist])
tableslists[[ndist]]= table(allscoreframe)
print(tableslists[[ndist]])
} #ndist
library(raster)
library('plot.matrix')
par(mfrow=c(4,4))
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mar=c(1,2,2,1) )
par(mfrow=c(4,4))
par(mar=c(1,2,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(4,4))
par(mar=c(2,3,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(4,4))
par(mar=c(2,4,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(4,4))
par(mar=c(1,4,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(4,4))
par(mar=c(3,4,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(4,4))
par(mar=c(4,4,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(4,4))
par(mar=c(4,4,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=1),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=.8),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(4,4))
par(mar=c(4,4,2,1) )
for(i in 1:14){
tt= tableslists[[i]]
as.data.frame.matrix(tt)
ttm=as.data.frame.matrix(tt)
ttm=as.matrix(ttm)
if( i==14){
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=1),
xlab="Rank", ylab="Series", main= dist_names[i]
)
}else{
plot(ttm,col=rev(heat.colors(10)),digits=0, text.cell=list(cex=1),
xlab="Rank", ylab="Series", main= dist_names[i], key=NULL
)
}
}
par(mfrow=c(1,1))
par(mar=c(2,2,2,1) )
matplot(datasetsimul[[4]], type="l", main="Quasi-periodic VAR(5) simulation", xlab="Time", ylab ="")
matplot(datasetsimul[[4]], type="l", main="Quasi-periodic VAR(3) simulation", xlab="Time", ylab ="")
